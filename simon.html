<!DOCTYPE html>
<html>
<head>
	<title></title>
	 <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"></script>
</head>
<style type="text/css">
	#main-board{
  height:900px;
  width:600px;
  margin:50px auto;
  }
.touch{
    width: 300px;
		height: 300px;
		cursor: pointer;
		border-radius: 2px;
		border: 10px solid #4E342E;
    float:left;
   
}

.pink{
  background-color: #FF4081;
}
.pink-active {
  background-color: #F50057 !important;
}
.yellow{
  background-color: #FFCA28;
}
.yellow-active {
  background-color: #FFEB3B !important;
}
.green{
  background-color:#43A047;
}
.green-active {
  background-color: darkgreen !important;
}
.blue{
  background-color:#7E57C2;
}
.blue-active {
  background-color: #651FFF !important;
}
.clear{
  clear:both;
}
#panel{
  width:300px;
  height:200px;
  position:absolute;
  margin-left:150px;
  margin-top:-380px;
 border: 6px solid  #4E342E;
  background-color:#fff;
  border-radius:10px;
}
#count{
  background-color:#FF7043;
  border-radius:2px;
}
#start{
 background-color:red;
  border-radius:50px;
}
#strict{
  background-color:yellow;
  border-radius:50px;
}
.play-btn{
  float:left;
  border:2px solid #000;
  width:50px;
  height:40px;
  margin-left:30px;
  text-align:center;
  font-weight:bold;
  
  font-size:1.5em;
}
.headline{
  text-align:center;
}
.btn{
  margin-left:18px;
  
}
.square-box{
  border: 4px solid black;
  width: 30px ;
  height: 30px;
  margin-left: 60px;
  background-color: red;
  border-radius:50px;}
.inline{
  float:left;
  
}
.start-btn{
  margin-left:20px;
  width:120px;
  height:30px;
  text-align:center;
  padding:0px;
}
button.start-btn{
  border:none;
  background-color:#757575;
  border-radius:2px;
}
.square-box-on{
  background-color:green;
}
@media only screen and (min-width: 240px) and (max-width: 767px){
  .touch{
    width:200px;
    height:220px;
    
  }
  #main-board{
  height:500px;
  width:400px;
  margin:50px auto;
  }
  #panel{
  width:220px;
  height:200px;
  position:absolute;
  margin-left:80px;
  margin-top:-330px;
 border: 6px solid  #4E342E;
  background-color:#fff;
  border-radius:10px;
}
.play-btn{
  float:left;
  border:2px solid #000;
  width:30px;
  height:36px;
 
  text-align:center;
  font-weight:bold;
  
  
}
.btn{
  margin:0px;
  
}
.square-box{
  margin-left: 20px;}

}

         
</style>
<body>
   <div class="col-xs-12">
     <div id="main-board">
       <div id="0" class="touch pink"></div>
       <div id="1" class="touch yellow"></div>
       <div id="2" class="touch green"></div>
       <div id="3" class="touch blue"></div>
       <div class="clear"></div>
       <div id="panel">
         <h1 class="headline">Simon</h1>
         <div class="play-btn" id="count">00</div>
         <div class="play-btn" id="start"></div>
         <div class="play-btn" id="strict"></div>
         <div class="btn score">Count</div>
         <div class="btn">Start</div>
         <div class="btn">Strict</div>
         <div class="square-box inline"></div>
         <div class="inline"><button class="start-btn">
           <b class="on-btn">ON</b><b class="off-btn">/OFF</b></button>
         
       </div>
     </div>
     
  </div>
</div>
<script type="text/javascript">
	var userInput = [];
var simonInput = [];
var winCase = 20;
var id,color;
var score =0;
var strict = false;
var error = false;
var gameStart = false;
var soundArr = [
  "https://s3.amazonaws.com/freecodecamp/simonSound1.mp3", //green
  "https://s3.amazonaws.com/freecodecamp/simonSound2.mp3", //red
  "https://s3.amazonaws.com/freecodecamp/simonSound3.mp3", //yellow 
  "https://s3.amazonaws.com/freecodecamp/simonSound4.mp3" //blue   
	];
$(document).ready(function(){
  $("#count").text("");
  $("#start").click(function(){
    strict = false;
    error = false;
    score = 0;
    score++;
    userInput = [];
    simonInput = [];
    simonTurn();
  
      });
  $(".touch").click(function(){
          id = $(this).attr("id");
          color = $(this).attr("class").split(" ")[1];
          userTurn();
  })
    $("#strict").click(function(){
      score = 0;
      score++;
      strict = true;
      userInput = [];
      simonInput = [];
      simonTurn();
      });
  $("button").click(function(){
    gameStart = (gameStart==false)?true:false;
    if(gameStart){
      $(".square-box").addClass("square-box-on");
      $("#count").text("00");
    }
    else{
      $(".square-box").removeClass("square-box-on");
      $("#count").text("");
    }
  });
  });
function userTurn(){
  userInput.push(id);
  addColorActive(id,color);
  if(!checkUserTurn()){
     if(strict){
    simonInput=[];
    score = 1;
  }
  error = true;
  errorOccur();
  userInput=[];
  simonTurn();
}
   else if(userInput.length==simonInput.length&&userInput.length<winCase){
     score++;
     error = false;
     simonTurn();
   }
  if(userInput.length==winCase){
    decareWinner();
    resetGame();
  }
}
 function checkUserTurn(){
   for(var i=0; i<userInput.length; i++){
     if(userInput[i] != simonInput[i]){
       return false;
     }
   }
   return true;
 }
function errorOccur(){
  var counter =0;
  var myError = setInterval(function(){
    $("#count").text("!!");
    counter++;
    if(counter==3){
      $("#count").text(score);
      clearInterval(myError);
      userInput = [];
      counter = 0;
    }
  },500);
}
function simonTurn(){
  $("#count").text(score);
  if(!error){
    getRandomNum();
  }
  if(error && strict){
    getRandomNum();
  }
  var i =0;
  var simonInterval = setInterval(function(){
    id = simonInput[i];
    color = $("#"+id).attr("class").split(" ")[1];
    console.log(id+" "+color);
    addColorActive(id,color);
    i++;
    if(i==simonInput.length){
      clearInterval(simonInterval);
    }
  },1000)
}
function getRandomNum(){
  var random = Math.floor(Math.random()*4);
  simonInput.push(random);
}
function addColorActive(id,color){
  $("#"+id).addClass(color+"-active");
  playSound(id);
  setTimeout(function(){
     $("#"+id).removeClass(color+"-active");
  },500);
}
function declareWinner(){
  var count = 0;
  var winInterval = setInterval(function(){
    count++;
    $("#count").text("Win");
    if(count==5){
      clearInterval(winInterval);
      $("#count").text("00");
      count=0;
    }
  },500);
}
function playSound(id){
  var sound = new Audio(soundArr[id]);
  sound.play();
}
function resetGame(){
  userInput = [];
  simonInput = [];
  score = 0;
  $("#count").text(score);
}


</script>

</body>
</html>
